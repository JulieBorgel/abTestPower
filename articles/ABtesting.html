<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frequentist vs Bayesian A/B Testing • abTestPower</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Frequentist vs Bayesian A/B Testing">
<meta property="og:description" content="abTestPower">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">abTestPower</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ABtesting.html">Frequentist vs Bayesian A/B Testing</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Frequentist vs Bayesian A/B Testing</h1>
            <h3 data-toc-skip class="subtitle">A/B testing applied to a
target prediction tool experimental validation</h3>
                        <h4 data-toc-skip class="author">Julie
Borgel</h4>
            
            <h4 data-toc-skip class="date">Nov 30 2022</h4>
      
      
      <div class="hidden name"><code>ABtesting.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://julieborgel.github.io/abTestPower/">abTestPower</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue" class="external-link">glue</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span></span>
<span> base_size <span class="op">=</span> <span class="fl">14</span>,</span>
<span> base_family <span class="op">=</span> <span class="st">"sans"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span> <span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="experiment-context">Experiment context<a class="anchor" aria-label="anchor" href="#experiment-context"></a>
</h2>
<p>We’ve recently developed a therapeutic target prediction tool which
has been developed to identify pharmacological key proteins and
prioritise therapeutic targets from a biological process represented in
a directed network. The tool has been tested in-silico against a dataset
of known therapeutic targets and is performing quite well. The details
of the in-silico validation is outside the scope of this article but the
main conclusions from this work are summarized below :</p>
<ul>
<li>The prediction tool scores all protein nodes of a network from 0 to
100. Proteins scoring above 75 are considered potential therapeutic
targets.</li>
<li>The in-silico validation shows that in average the hit rate
(precision) of the top-scorer (protein score &gt;= 75) is 1 target
(success) out of 15 proteins tested (trials).</li>
<li>Low-scorer hit rate is 1/network size and the average size of the
networks in the validation dataset is 150 proteins, therefore the
expected low-scoring proteins hit rate 1 target (success) out of 150
proteins tested (trials).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">topScorerHitRate</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">15</span></span>
<span><span class="va">lowScorerhitRate</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">150</span></span></code></pre></div>
<p>Although, the in-silico validation results are quite promising, we
should run some experimental validation to be absolutely sure that the
prediction tool is indeed identifying therapeutic targets at a better
rate than what we would get by random chances. More precisely, we want
to compare in an assay the top-scorer hit rate to the low-scorer hit
rate. This is assuming that we already have an experimental assay set up
and that we know exactly how to define a hit. The details of the
experimental design is also outside the scope of this article. However,
while designing the experimental validation we had to consider how to
analyse the data after the assay had run. Comparing hit rates in this
context would be the equivalent of running an A/B test which is widely
used to compare 2 versions of a website by comparing their
click-through-rate. There are two main ways of running such test: The
Frequentist approach or the Bayesian approach. These are two different
inferential statistical methods and there is a lot of debate over which
is “The Best”. In this article we are assuming the reader knows the main
differences between both methods and we simply want to show how these
methods can be used and the consequences it has on the experimental
design.</p>
</div>
<div class="section level2">
<h2 id="sample-size">Sample size<a class="anchor" aria-label="anchor" href="#sample-size"></a>
</h2>
<p>As for any experimental set up we need to determine the smallest
sample size that is suitable to detect the difference of hit rates and
avoid Type I (false positive) and Type II (false negative) errors. The
more data points we have the better but experiments are very expensive
to run and we need to try to keep cost as low as possible.</p>
<p>We can run the both approaches for multiple sample sizes and pick the
best at the end :</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">topScorerSampleSize</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">100</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">topScorerSampleSize</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"sampleSize = {topScorerSampleSize}"</span><span class="op">)</span></span>
<span><span class="va">lowScorerSampleSize</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">100</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lowScorerSampleSize</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"sampleSize = {lowScorerSampleSize}"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>top-scorer sample size to be tested : 50, 75, 100, 500</li>
<li>low-scorer sample size to be tested : 25, 50, 75, 100, 500</li>
</ul>
<p>We know already that we can’t afford the cost of 500 data points in
each sample but we are still curious to see the results with such large
sample size.</p>
</div>
<div class="section level2">
<h2 id="the-frequentist-approach-power-analysis">The Frequentist approach : Power Analysis<a class="anchor" aria-label="anchor" href="#the-frequentist-approach-power-analysis"></a>
</h2>
<p>The <code>runFrequentistPower</code> method runs a Frequentist power
analysis for 2 proportions on multiple sample sizes. It returns the
results as a tidy table which can be plotted using the <code>plot</code>
method.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">powerTests</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runFrequentistPower.html">runFrequentistPower</a></span><span class="op">(</span><span class="va">topScorerHitRate</span>,</span>
<span>  <span class="va">topScorerSampleSize</span>,</span>
<span>  <span class="va">lowScorerhitRate</span>,</span>
<span>  <span class="va">lowScorerSampleSize</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"greater"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The plot below shows the statistical power for each combination of
sample size. We can easily see that only the largest sample size (500)
reaches enough power (&gt;=0.9). Therefore we can easily conclude that
the experiment would most probably be too expensive if we were to use
the Frequentist approach to analyse the data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">powerTests</span>, <span class="va">topScorerSampleSize</span>, <span class="va">lowScorerSampleSize</span>, <span class="va">power</span><span class="op">)</span></span></code></pre></div>
<p><img src="ABtesting_files/figure-html/unnamed-chunk-4-1.png" width="1920" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="the-bayesian-approach-simulated-analysis">The Bayesian approach : Simulated analysis<a class="anchor" aria-label="anchor" href="#the-bayesian-approach-simulated-analysis"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="va">beta</span> <span class="op">=</span> <span class="fl">33</span></span></code></pre></div>
<div class="section level3">
<h3 id="choosing-a-data-distribution-prior">Choosing a Data Distribution &amp; Prior<a class="anchor" aria-label="anchor" href="#choosing-a-data-distribution-prior"></a>
</h3>
<p>In this scenario, the binomial distribution describes our binary data
(hit = TRUE or hit = FALSE). The prior represent the strength of our
belief before we see the data and choosing a prior is an important
aspect of Bayesian experimentation methods. We’re going to use the beta
distribution to model our hit rate since it’s a good conjugate prior for
binomial distribution. Remember that when we use beta distribution for a
binary trial, the first shape represent the number of success while the
second is the number of failure. Luckily for us a previous version of
the prediction tool has been experimentally tested in our assay and
we’ve found 2 targets out of 35 proteins tested.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numSteps</span> <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">numSteps</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>,</span>
<span>                 shape1 <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>                 shape2 <span class="op">=</span> <span class="va">beta</span><span class="op">)</span></span>
<span>       <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span>, title <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"Beta probability density function for parameters : alpha = {alpha}, beta = {beta}"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ABtesting_files/figure-html/unnamed-chunk-6-1.png" width="1920" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="run-ab-test-on-simulated-data">Run A/B test on simulated data<a class="anchor" aria-label="anchor" href="#run-ab-test-on-simulated-data"></a>
</h3>
<p>Power analysis doesn’t really apply to Bayesian statistics, however,
we still need to estimate the sample size in advance to be able to
perform the experiment without risking to not have enough data points to
detect whether the top-scorer hit rate is better than the low-scorer hit
rate. Running simulations of our experiment will help us to choose a
sensible required sample size for each group. The
<code>runABbayesTest</code> method has been designed to run Bayesian A/B
test on multiple simulated data randomly generated using the appropriate
distribution based on the top-scorer and low-scorer hit rates. The
method is also running for multiple sample sizes and returns the results
as a tidy table which can be plotted using the <code>plot</code>
method.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bayesABtests</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runABbayesTest.html">runABbayesTest</a></span><span class="op">(</span><span class="va">topScorerHitRate</span>,</span>
<span>  <span class="va">topScorerSampleSize</span>,</span>
<span>  <span class="va">lowScorerhitRate</span>,</span>
<span>  <span class="va">lowScorerSampleSize</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span> <span class="op">=</span> <span class="va">alpha</span>, <span class="st">"beta"</span> <span class="op">=</span> <span class="va">beta</span><span class="op">)</span>,</span>
<span>  distribution <span class="op">=</span> <span class="st">"bernoulliC"</span>,</span>
<span>  nSimulatedData <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The plot below shows the probability of top-scorer hit rate to be
better than low-scorer hit rate. It is very different than the plot
showing the Frequentist power analysis results. Nevertheless, it is
showing that using the Bayesian approach would allow us to reduce the
sample size as low as 75 and still be able to detect the difference in
hit rates with a probability &gt;= 0.9.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bayesABtests</span>, <span class="va">topScorerSampleSize</span>, <span class="va">lowScorerSampleSize</span>, <span class="va">probability</span><span class="op">)</span></span></code></pre></div>
<p><img src="ABtesting_files/figure-html/unnamed-chunk-8-1.png" width="1920" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>We’ve been able to show how to use the abTestPower R package to apply
Frequentist and Bayesian approach to A/B testing. We shown that the
Bayesian approach will allow us to reduce the sample size. The article
can be used as a guide to perform the statistical analysis for when the
results from the assay are delivered.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julie Borgel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
